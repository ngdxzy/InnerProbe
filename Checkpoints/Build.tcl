exec wsl ./cleanup.sh
update_compile_order -fileset sources_1
export_ip_user_files -of_objects  [get_files D:/vivado/ZCU104/InnerProbe/Checkpoints/*.dcp] -no_script -reset -force -quiet
remove_files  D:/vivado/ZCU104/InnerProbe/Checkpoints/cell_*.dcp

#Synthesis cap 1
startgroup
set_property -dict [list CONFIG.FF_NUM {2}] [get_bd_cells CapLoad/Cap_0]
set_property -dict [list CONFIG.FF_NUM {2}] [get_bd_cells CapLoad/Cap_1]
endgroup
save_bd_design
reset_run synth_1
launch_runs synth_1 -jobs 4
wait_on_run synth_1

open_run synth_1 -name synth_1

write_checkpoint -cell InnerProbe_i/CapLoad ./cell_probed.dcp

set_property HD.RECONFIGURABLE 1 [get_cells InnerProbe_i/CapLoad]
#do PR Rules check
create_drc_ruledeck ruledeck_1
add_drc_checks -ruledeck ruledeck_1 [get_drc_checks {PDRC-159 PDRC-158 PDRC-153 PDIL-1 PDCN-1569 PDCN-2736 PDCN-2735 PDCN-2732 PDCN-2731 PDCN-2730 PDCN-2729 PDCN-2728 PDCN-2727 PDCN-2726 PDCN-2725 PDCN-2724 PDCN-2723 PDCN-2722 PDCN-2711 PDCN-2709 PDCN-2707 PDCN-2706 PDCN-2705 PDCN-2704 PDCN-2703 PDCN-2702 PDCN-2701 PDCN-2696 PDCN-2695 PDCN-2694 PDCN-2693 PDCN-2692 PDCN-2691 PDCN-2682 PDCN-2681 PDCN-2680 PDCN-2676 PDCN-2675 PDCN-2674 PDCN-2673 PDCN-2672 PDCN-2671 PDCN-2670 PDCN-2669 PDCN-2668 PDCN-2667 PDCN-2666 PDCN-2665 PDCN-2664 PDCN-2663 PDCN-2662 PDCN-2661 PDCN-2660 PDCN-2659 PDCN-2658 PDCN-2657 PDCN-2656 PDCN-2655 PDCN-2654 PDCN-2653 PDCN-2652 PDCN-2651 PDCN-2650 PDCN-2649 PDCN-2648 PDCN-2647 PDCN-2646 PDCN-2645 PDCN-2644 PDCN-2643 PDCN-2642 PDCN-2641 PDCN-2640 PDCN-2639 PDCN-2638 PDCN-2637 PDCN-2636 PDCN-2635 PDCN-2634 PDCN-2633 PDCN-2632 PDCN-2631 PDCN-2630 PDCN-2629 PDCN-2628 PDCN-2627 PDCN-2626 PDCN-2625 PDCN-2624 PDCN-2623 PDCN-2622 PDCN-2621 PDCN-2620 PDCN-2619 PDCN-2618 PDCN-2617 PDCN-2616 PDCN-2615 PDCN-2614 PDCN-2613 PDCN-2612 PDCN-2611 PDCN-2610 PDCN-2609 PDCN-2608 PDCN-2607 PDCN-2606 PDCN-2605 PDCN-2604 PDCN-2603 PDCN-2602 PDCN-2601 PDCN-2600 PDCN-2599 PDCN-2598 PDCN-2597 PDCN-2596 PDCN-2595 PDCN-2594 PDCN-2593 PDCN-2592 PDCN-2591 PDCN-2590 PDCN-2589 PDCN-2588 PDCN-2587 PDCN-2586 PDCN-2585 PDCN-2584 PDCN-2583 PDCN-2582 PDCN-2581 PDCN-2580 PDCN-2579 PDCN-2578 PDCN-2577 PDCN-2576 PDCN-2575 PDCN-2574 PDCN-2573 PDCN-2572 PDCN-2571 PDCN-2570 PDCN-2569 PDCN-2568 PDCN-2567 PDCN-2566 PDCN-2565 PDCN-2518 PDCN-2311 PDCN-2310 PDCN-2309 PDCN-2308 PDCN-2293 PDCN-2292 PDCN-2291 PDCN-2290 PDCN-1873 PDCN-1872 PDCN-1871 PDCN-1870 PDCN-1869 PDCN-1868 PDCN-1867 PDCN-1866 PDCN-1865 PDCN-1864 PDCN-1855 PDCN-1854 PDCN-1853 PDCN-1852 PDCN-1851 PDCN-1850 PDCN-1849 PDCN-1848 PDCN-1847 PDCN-1845 PDCN-1844 PDCN-1842 PDCN-1841 PDCN-1840 PDCN-1839 PDCN-1838 PDCN-1837 PDCN-1836 PDCN-2700 PDCN-2699 PDCN-2698 PDCN-2697 PDCN-1835 PDCN-1834 PDCN-1833 PDCN-1832 PDCN-1831 PDCN-1830 PDCN-1829 PDCN-1828 PDCN-2679 PDCN-2678 PDCN-2677 PDCN-1824 PDCN-1823 PDCN-1822 PDCN-2564 PDCN-2563 PDCN-2562 PDCN-2561 PDCN-2560 PDCN-2559 PDCN-2558 PDCN-2557 PDCN-2556 PDCN-2555 PDCN-2554 PDCN-2553 PDCN-2552 PDCN-2551 PDCN-2550 PDCN-2549 PDCN-2548 PDCN-2547 PDCN-2546 PDCN-2545 PDCN-2544 PDCN-2543 PDCN-2542 PDCN-2541 PDCN-2540 PDCN-2539 PDCN-2538 PDCN-2537 PDCN-2536 PDCN-2535 PDCN-2534 PDCN-1821 PDCN-1820 PDCN-1819 PDCN-1818 PDCN-1817 PDCN-1816 PDCN-1815 PDCN-1814 PDCN-1813 PDCN-1812 PDCN-1811 PDCN-1810 PDCN-1809 PDCN-1808 PDCN-1807 PDCN-1806 PDCN-1805 PDCN-1804 PDCN-1803 PDCN-1802 PDCN-1801 PDCN-1800 PDCN-1799 PDCN-1798 PDCN-1797 PDCN-1796 PDCN-1795 PDCN-1794 PDCN-1793 PDCN-1792 PDCN-1791 PDCN-1790 PDCN-2533 PDCN-2532 PDCN-2531 PDCN-2530 PDCN-2529 PDCN-2528 PDCN-2527 PDCN-2526 PDCN-2525 PDCN-2524 PDCN-2523 PDCN-2522 PDCN-2521 PDCN-2520 PDCN-2519 PDCN-1789 PDCN-1788 PDCN-1787 PDCN-1786 PDCN-1785 PDCN-1784 PDCN-1783 PDCN-1782 PDCN-1781 PDCN-1780 PDCN-1779 PDCN-1778 PDCN-1777 PDCN-1776 PDCN-1775 PDCN-1774 PDCN-2517 PDCN-2516 PDCN-2515 PDCN-2514 PDCN-2513 PDCN-2512 PDCN-2511 PDCN-2510 PDCN-1773 PDCN-1772 PDCN-1749 PDCN-1748 PDCN-1747 PDCN-2307 PDCN-2306 PDCN-2305 PDCN-2304 PDCN-2303 PDCN-2302 PDCN-2301 PDCN-2300 PDCN-2299 PDCN-2298 PDCN-2297 PDCN-2296 PDCN-2295 PDCN-2294 PDCN-1746 PDCN-2733 PDCN-1745 PDCN-1744 PDCN-1877 PDCN-1657 PDCN-1656 PDCN-1655 PDCN-1654 PDCN-1653 PDCN-1652 PDCN-1651 PDCN-1650 PDCN-1649 PDCN-1648 PDCN-1647 PDCN-1646 PDCN-1645 PDCN-1644 PDCN-1643 PDCN-1642 PDCN-1641 PDCN-1640 PDCN-1639 PDCN-1638 PDCN-1637 PDCN-1636 PDCN-1635 PDCN-1634 PDCN-1633 PDCN-1632 PDCN-1631 PDCN-1630 PDCN-1629 PDCN-1628 PDCN-1627 PDCN-1626 PDCN-1625 PDCN-1624 PDCN-1623 PDCN-1622 PDCN-1621 PDCN-1620 PDCN-1619 PDCN-1618 PDCN-1876 PDCN-1617 PDCN-1616 PDCN-1615 PDCN-1614 PDCN-1613 PDCN-1612 PDCN-1611 PDCN-1610 PDCN-1609 PDCN-1608 PDCN-1607 PDCN-1606 PDCN-1605 PDCN-1604 PDCN-1603 PDCN-1602 PDCN-1601 PDCN-1600 PDCN-1599 PDCN-1875 PDCN-1874 PDCN-1598 PDCN-1597 PDCN-1596 PDCN-1595 PDCN-1594 PDCN-1863 PDCN-1862 PDCN-1861 PDCN-1860 PDCN-1859 PDCN-1858 PDCN-1857 PDCN-1856 PDCN-1593 PDCN-1592 PDCN-1591 PDCN-1590 PDCN-1846 PDCN-1589 PDCN-1588 PDCN-1587 PDCN-1586 PDCN-1585 PDCN-1843 PDCN-1584 PDCN-1583 PDCN-1582 PDCN-1581 PDCN-1580 PDCN-1579 PDCN-1578 PDCN-1577 PDCN-2708 PDCN-1575 PDCN-1568 PDCN-1567 PDCN-1561 PDCN-1560 PDCN-1559 PDCN-1558 PDCN-1557 PDCN-1556 PDCN-1555 PDCN-1554 PDCN-1553 PDCN-1227 PDCN-1226 PDCN-1225 PDCN-1224 PDCN-1223 PDCN-1222 PDCN-1221 PDCN-1220 PDCN-1219 PDCN-1218 PDCN-1217 PDCN-1207 PDCN-1206 PDCN-1205 PDCN-1204 PDCN-1203 PDCN-1202 PDCN-1201 PDCN-1200 PDCN-1199 PDCN-1198 PDCN-1197 PDCN-1196 PDCN-1195 PDCN-1194 PDCN-1193 PDCN-1192 PDCN-1191 PDCN-1190 PDCN-1189 PDCN-798 PDCN-797 PDCN-796 PDCN-795 PDCN-794 PDCN-793 PDCN-792 PDCN-791 PDCN-790 PDCN-789 PDCN-788 PDCN-787 PDCN-786 PDCN-785 PDCN-784 PDCN-783 PDCN-782 PDCN-781 PDCN-780 PDCN-779 PDCN-771 PDCN-770 PDCN-769 PDCN-768 PDCN-767 PDCN-766 PDCN-765 PDCN-160 PDCN-159 PDCN-2690 PDCN-2689 PDCN-2688 PDCN-2687 PDCN-2686 PDCN-2685 PDCN-2684 PDCN-2683 PDCN-1827 PDCN-1826 PDCN-1825 PDCN-158 PDCN-157 PDCN-156 PDCN-155 PDCN-154 PDCN-153 PDCN-152 PDCN-151 PDCN-150 PDCN-149 PDCN-148 PDCN-147 PDCN-146 PDCN-145 PDCN-144 PDCN-143 PDCN-142 PDCN-141 PDCN-140 PDCN-139 PDCN-138 PDCN-137 PDCN-136 PDCN-135 PDCN-134 PDCN-133 PDCN-132 PDCN-131 PDCN-130 PDCN-129 PDCN-128 PDCN-127 PDCN-126 PDCN-125 PDCN-124 PDCN-123 PDCN-122 PDCN-121 PDCN-120 PDCN-119 PDCN-118 PDCN-117 PDCN-116 PDCN-115 PDCN-114 PDCN-113 PDCN-112 PDCN-111 PDCN-110 PDCN-109 PDCN-108 PDCN-107 PDCN-106 PDCN-105 PDCN-104 PDCN-103 PDCN-102 PDCN-101 PDCN-100 PDCN-99 PDCN-98 PDCN-97 PDCN-96 PDCN-95 PDCN-94 PDCN-93 PDCN-92 PDCN-91 PDCN-90 PDCN-89 PDCN-88 PDCN-87 PDCN-86 PDCN-85 PDCN-84 PDCN-83 PDCN-82 PDCN-81 PDCN-80 PDCN-79 PDCN-78 PDCN-77 PDCN-76 PDCN-75 PDCN-74 PDCN-73 PDCN-72 PDCN-71 PDCN-70 PDCN-69 PDCN-68 PDCN-67 PDCN-66 PDCN-65 PDCN-64 PDCN-63 PDCN-62 PDCN-61 PDCN-60 PDCN-59 PDCN-58 PDCN-57 PDCN-56 PDCN-55 PDCN-54 PDCN-53 PDCN-52 PDCN-51 PDCN-50 PDCN-49 PDCN-48 PDCN-47 PDCN-46 PDCN-45 PDCN-44 PDCN-43 PDCN-42 PDCN-41 PDCN-40 PDCN-39 PDCN-38 PDCN-37 PDCN-36 PDCN-35 PDCN-34 PDCN-33 PDCN-32 PDCN-31 PDCN-30 PDCN-29 PDCN-28 PDCN-27 PDCN-26 PDCN-25 PDCN-24 PDCN-23 PDCN-22 PDCN-21 PDCN-20 PDCN-19 PDCN-18 PDCN-17 PDCN-16 PDCN-15 PDCN-14 PDCN-13 PDCN-12 PDCN-11 PDCN-10 PDCN-9 PDCN-8 PDCN-7 PDCN-1574 PDCN-1573 PDCN-1572 PDCN-184 PDCN-183 PDCN-182 PDCN-181 PDCN-180 PDCN-179 PDCN-178 PDCN-177 PDCN-176 PDCN-175 PDCN-174 PDCN-173 PDCN-172 PDCN-171 PDCN-170 PDCN-169 PDCN-168 PDCN-167 PDCN-166 PDCN-165 PDCN-164 PDCN-163 PDCN-162 PDCN-6 PDCN-5 PDCN-4 PDCN-3 PDCN-1571 PDCN-2 PDAD-11 PDAD-10 PDAD-9 PDAD-8 PDAD-7 PDAD-6 PDAD-5 PDAD-4 PDAD-3 PDAD-2 PDRC-149 PDRC-206 PDRC-209 PDRC-208 PDRC-205 PDRC-202 PDRC-196 PDRC-195 PDRC-192 PDRC-213 PDRC-203 PDRC-193 PDRC-191 PDRC-201 PDRC-198 PDRC-186 PDRC-187 PDRC-185 PDRC-184 PDRC-183 PDRC-173 PDRC-172 PDRC-171 PDRC-170 PDRC-197 PDRC-182 PDRC-181 PDRC-180 PDRC-169 PDRC-168 PDRC-179 PDRC-178 PDRC-177 PDRC-176 PDRC-167 PDRC-166 PDRC-150 PDRC-138 PDRC-137 PDRC-136 PDRC-135 PDRC-134 PDRC-133 PDRC-132 PDRC-131 PDRC-100 PDRC-152 PDRC-95 PDRC-154 PDRC-151 PDRC-94 PDRC-93 PDRC-146 PDRC-145 PDRC-144 PDRC-143 PDRC-142 PDRC-141 PDRC-140 PDRC-139 PDRC-92 PDRC-91 PDRC-90 PDRC-89 PDRC-88 PDRC-87 PDRC-86 PDRC-85 PDRC-84 PDRC-83 PDRC-82 PDRC-81 PDRC-80 PDRC-79 PDRC-78 PDRC-77 PDRC-76 PDRC-75 PDRC-74 PDRC-73 PDRC-72 PDRC-71 PDRC-70 PDRC-69 PDRC-68 PDRC-67 PDRC-66 PDRC-65 PDRC-64 PDRC-60 PDRC-53 PDRC-52 PDRC-51 PDRC-50 PDRC-49 PDRC-48 PDRC-47 PDRC-46 PDRC-45 PDRC-44 PDRC-43 PDRC-42 PDRC-39 PDRC-38 PDRC-36 PDRC-35 PDRC-34 PDRC-33 PDRC-30 PDRC-29 PDRC-28 PDRC-27 PDRC-24 PDRC-23 PDRC-22 PDRC-21 PDRC-20 PDRC-19 PDRC-18 PDRC-17 PDRC-16 PDRC-15 PDRC-14 PDRC-13 PDRC-12 PDRC-11 PDRC-10 PDRC-9 PDRC-8 PDRC-7 PDRC-6 PDRC-5 PDRC-4 PDRC-3 PDRC-2 PDRC-200 PDCY-1 AVAL-270 AVAL-269 AVAL-253 AVAL-252}]
report_drc -name drc_1 -ruledecks {ruledeck_1}

#Routing
opt_design
place_design
route_design



#clean up partial region
update_design -cells InnerProbe_i/CapLoad -black_box
lock_design -level routing

write_checkpoint ./routed_static.dcp -force

read_checkpoint -cell InnerProbe_i/CapLoad ./cell_probed.dcp

opt_design
place_design
route_design

write_checkpoint ./routed_probed.dcp -force

pr_verify -initial ./routed_static.dcp -additional {./routed_probed.dcp} 
#./routed_cap8.dcp ./routed_probed6.dcp}

#write_bitstream
open_checkpoint ./routed_static.dcp
write_bitstream ./static.bit -force
close_design

open_checkpoint ./routed_probed.dcp
write_bitstream ./probed.bit -force
close_design


close_design

exec wsl echo "Finished! Do bit 2 bin transfer"

exec wsl ./bit2bin.sh

exec wsl echo "All set"
